api:
  dashboard: true       # Enable Traefik Dashboard
  insecure: false       # Not allow insecure access to Dashboard

entryPoints:
  http:
    address: ":80"
  https:
    address: ":443"
    forwardedHeaders:
      trustedIPs:
        # Cloudflare IPv4 ranges
        - "173.245.48.0/20"
        - "103.21.244.0/22"
        - "103.22.200.0/22"
        - "103.31.4.0/22"
        - "141.101.64.0/18"
        - "108.162.192.0/18"
        - "190.93.240.0/20"
        - "188.114.96.0/20"
        - "197.234.240.0/22"
        - "198.41.128.0/17"
        - "162.158.0.0/15"
        - "104.16.0.0/13"
        - "104.24.0.0/14"
        - "172.64.0.0/13"
        - "131.0.72.0/22"

providers:
  docker:
    endpoint: "unix:///var/run/docker.sock"     # Automatic find container by Docker socket
    exposedByDefault: false                     # Not expose containers by default, only those marked traefik.enable=true will be routed
    network: traefik_network                    # Use traefik_network network for service discovery
  file:
    filename: /config.yml                       # Load additional dynamic configuration from config.yml
    watch: true                                 # Watch file changes and automatically reload

log:
  level: INFO                                   # Log level: DEBUG/INFO/WARN/ERROR
  filePath: "/var/log/traefik/traefik.log"      # Traefik main log file path
accessLog:
  filePath: "/var/log/traefik/access.log"       # Access log file path (read by Fail2Ban)
  format: json                                  # Use JSON format for easy parsing
  fields:
    headers:
      names:
        CF-Connecting-IP: keep                  # Keep Cloudflare real IP header
        X-Forwarded-For: keep                   # Keep X-Forwarded-For header
        X-Real-IP: keep                         # Keep X-Real-IP header